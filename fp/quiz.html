<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Privacy Awareness Quiz</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Arial', sans-serif; background: #0f1724; color: #e6eef5; }
    .card { background: #0b1220; padding: 20px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.4); margin-bottom: 20px; }
    .btn { background: #16a34a; color: white; padding: 10px 18px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: all 0.3s; }
    .btn:hover { background: #15803d; }
    .disabled { opacity: 0.5; pointer-events: none; }
    .option { padding: 10px; margin: 6px 0; border-radius: 6px; background: #1e293b; cursor: pointer; transition: 0.3s; }
    .option:hover { background: #334155; }
    .correct { background: #14532d !important; color: #22c55e; }
    .wrong { background: #7f1d1d !important; color: #f87171; }
    #leaderboard li { margin: 4px 0; }
    @keyframes popIn {
      0% { opacity: 0; transform: scale(0.6); }
      60% { opacity: 1; transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    .congrats-msg {
      font-size: 1.8rem;
      font-weight: bold;
      color: #16a34a;
      text-align: center;
      margin-top: 20px;
      animation: popIn 1s ease forwards;
    }
  </style>
</head>
<body class="p-4">

  <!-- Name Entry Panel -->
  <div id="startPanel" style="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:#0f1724;z-index:50">
    <div class="card" style="max-width:350px;width:100%;text-align:center">
      <h2 class="text-green-500 mb-4">Enter Your Name</h2>
      <input id="startName" placeholder="Your name" class="w-full p-2 rounded bg-transparent border border-gray-600 mb-4 text-white" />
      <button class="btn w-full" id="startBtn">Start Quiz</button>
    </div>
  </div>

  <header class="text-center mb-6">
    <h1 class="text-3xl font-bold text-green-500">Data Privacy Awareness Quiz</h1>
  </header>

  <main class="grid md:grid-cols-3 gap-4">
    <!-- Sidebar -->
    <aside class="card md:col-span-1">
      <h2 class="text-xl font-bold mb-2">Player Info</h2>
      <label class="block mb-2">Name: <input id="playerName" class="p-1 rounded text-black w-full"></label>
      <p>Score: <span id="score">0</span></p>
      <p>Time Left: <span id="timer">--</span>s</p>
      <hr class="my-3 border-gray-600">
      <h2 class="text-xl font-bold mb-2">Levels</h2>
      <button id="beginnerBtn" class="btn w-full mb-2">Beginner</button>
      <button id="intermediateBtn" class="btn w-full mb-2 disabled">Intermediate</button>
      <button id="advancedBtn" class="btn w-full disabled">Advanced</button>
      <hr class="my-3 border-gray-600">
      <h2 class="text-xl font-bold mb-2">Leaderboard</h2>
      <ul id="leaderboard" class="list-decimal list-inside text-sm"></ul>
    </aside>

    <!-- Quiz Area -->
    <section class="md:col-span-2">
      <div id="quizCard" class="card hidden">
        <h2 id="levelTitle" class="text-xl font-bold mb-2"></h2>
        <p id="questionText" class="mb-4"></p>
        <div id="options" class="mb-4"></div>
        <button id="nextBtn" class="btn hidden">Next Question</button>
      </div>
      <div id="endCard" class="card hidden text-center">
        <h2 class="text-xl font-bold">Level Complete</h2>
        <p>Your Score: <span id="finalScore"></span>/<span id="finalTotal"></span></p>
        <p>Percentage: <span id="finalPercent"></span>%</p>
        <button id="nextLevelBtn" class="btn hidden">Next Level</button>
        <button id="retryBtn" class="btn hidden">Retry</button>
        <button id="saveScoreBtn" class="btn hidden">Save Score</button>
      </div>
    </section>
  </main>

  <script>
    const beginnerQs=[
      {q:"What does CPU stand for?",opts:["Central Processing Unit","Computer Personal Unit","Central Program Utility","Control Processing Unit"],a:0},
      {q:"Which one is an Input device?",opts:["Monitor","Keyboard","Speaker","Printer"],a:1},
      {q:"Which one is an Output device?",opts:["Mouse","Scanner","Printer","Keyboard"],a:2},
      {q:"What is the brain of the computer?",opts:["Monitor","CPU","RAM","Hard Disk"],a:1},
      {q:"Which stores data permanently?",opts:["RAM","ROM","Cache","Registers"],a:1}
    ];
    const intermediateQs=[
      {q:"What does HTTP stand for?",opts:["HyperText Transfer Protocol","HighText Transfer Protocol","Hyper Transfer Text Process","Hyperlink Text Protocol"],a:0},
      {q:"Which database is NoSQL?",opts:["MySQL","MongoDB","Oracle","PostgreSQL"],a:1},
      {q:"What is API?",opts:["Application Programming Interface","Advanced Program Interaction","Automated Processing Input","Application Protocol Integration"],a:0},
      {q:"Which one is version control?",opts:["Linux","Git","Python","Java"],a:1},
      {q:"Which one is NOT programming language?",opts:["Python","HTML","C++","Java"],a:1}
    ];
    const advancedQs=[
      {q:"What is Big O notation used for?",opts:["Measure algorithm efficiency","Design UI","Encrypt data","Connect databases"],a:0},
      {q:"Which is Machine Learning library?",opts:["TensorFlow","React","Django","Laravel"],a:0},
      {q:"REST API commonly uses which protocol?",opts:["SMTP","HTTP","FTP","SSH"],a:1},
      {q:"Which technology is used for containerization?",opts:["Docker","GitHub","Kubernetes","Apache"],a:0},
      {q:"Blockchain is primarily known for?",opts:["Cryptocurrency","AI","Web Servers","Email"],a:0}
    ];
    let currentLevel="";let currentSet=[];let qIndex=0;let score=0;let timer;let timeLeft=30;const PASS_PERCENT=60;
    const scoreDisplay=document.getElementById('score');
    const timerDisplay=document.getElementById('timer');
    const quizCard=document.getElementById('quizCard');
    const endCard=document.getElementById('endCard');
    const levelTitle=document.getElementById('levelTitle');
    const questionText=document.getElementById('questionText');
    const optionsWrap=document.getElementById('options');
    const nextBtn=document.getElementById('nextBtn');
    const finalScore=document.getElementById('finalScore');
    const finalTotal=document.getElementById('finalTotal');
    const finalPercent=document.getElementById('finalPercent');
    const nextLevelBtn=document.getElementById('nextLevelBtn');
    const retryBtn=document.getElementById('retryBtn');
    const saveScoreBtn=document.getElementById('saveScoreBtn');
    const beginnerBtn=document.getElementById('beginnerBtn');
    const intermediateBtn=document.getElementById('intermediateBtn');
    const advancedBtn=document.getElementById('advancedBtn');
    const playerNameInput=document.getElementById('playerName');
    const leaderboard=document.getElementById('leaderboard');

    function startLevel(level){
      currentLevel=level;score=0;scoreDisplay.textContent=score;
      if(level==="beginner"){currentSet=[...beginnerQs];}
      else if(level==="intermediate"){currentSet=[...intermediateQs];}
      else{currentSet=[...advancedQs];}
      qIndex=0;shuffle(currentSet);showQuestion();
      quizCard.classList.remove('hidden');endCard.classList.add('hidden');
    }
    function showQuestion(){
      if(qIndex>=currentSet.length){finishLevel();return;}
      const q=currentSet[qIndex];
      levelTitle.textContent=`${currentLevel.toUpperCase()} - Q${qIndex+1}`;
      questionText.textContent=q.q;
      optionsWrap.innerHTML="";
      q.opts.forEach((opt,idx)=>{
        const btn=document.createElement('div');
        btn.textContent=opt;btn.className='option';
        btn.onclick=()=>checkAndMark(idx);
        optionsWrap.appendChild(btn);
      });
      nextBtn.classList.add('hidden');timeLeft=30;startTimer();
    }
    function checkAndMark(selectedIndex){
      clearTimer();
      const q=currentSet[qIndex];
      const options = optionsWrap.querySelectorAll('.option');
      options.forEach((opt,idx)=>{
        opt.style.pointerEvents='none';
        if(q.a===idx){ opt.classList.add('correct'); }
        else if(idx===selectedIndex){ opt.classList.add('wrong'); }
      });
      if(selectedIndex===q.a){ score++; scoreDisplay.textContent=score; }
      nextBtn.classList.remove('hidden');
    }
    nextBtn.onclick=()=>{ qIndex++; showQuestion(); };

    function finishLevel(){
      clearTimer();
      endCard.classList.remove('hidden');
      quizCard.classList.add('hidden');
      finalScore.textContent=score;
      finalTotal.textContent=currentSet.length;
      const percent=Math.round((score/currentSet.length)*100);
      finalPercent.textContent=percent;

      const oldMsg=endCard.querySelector('#resultMsg');
      if(oldMsg) oldMsg.remove();
      const messageBox=document.createElement('div');
      messageBox.id='resultMsg';
      messageBox.style.marginTop="12px";
      messageBox.style.fontWeight="600";

      if(percent>=PASS_PERCENT){
        messageBox.style.color="#16a34a";
        messageBox.textContent="🎉 Congratulations! You unlocked the next level!";
        nextLevelBtn.classList.remove('hidden');
        retryBtn.classList.remove('hidden');
        saveScoreBtn.classList.remove('hidden');

        if(currentLevel==="advanced"){
          const finalMsg=document.createElement('div');
          finalMsg.className="congrats-msg";
          finalMsg.textContent="🎉 Congratulations, you have learned about data privacy!";
          endCard.appendChild(finalMsg);
          nextLevelBtn.classList.add('hidden');
        }
      } else {
        messageBox.style.color="#dc2626";
        let topicInfo="";
        if(currentLevel==="beginner"){
          topicInfo=" (Basics of Computers: CPU, Input/Output devices, Storage, and Operating Systems).";
        } else if(currentLevel==="intermediate"){
          topicInfo=" (Intermediate Concepts: HTTP, Databases, APIs, and Git).";
        } else if(currentLevel==="advanced"){
          topicInfo=" (Advanced Concepts: Algorithms, Machine Learning, REST APIs, Docker, and Blockchain).";
        }
        messageBox.textContent=`⚠️ You need to learn and focus more on this topic: ${currentLevel.toUpperCase()} ${topicInfo}`;
        nextLevelBtn.classList.add('hidden');
        retryBtn.classList.remove('hidden');
        saveScoreBtn.classList.remove('hidden');
      }
      endCard.appendChild(messageBox);
      saveProgress(percent);
      applyUnlocks();
    }

    function startTimer(){
      timerDisplay.textContent=timeLeft;
      timer=setInterval(()=>{
        timeLeft--;timerDisplay.textContent=timeLeft;
        if(timeLeft<=0){clearTimer();finishLevel();}
      },1000);
    }
    function clearTimer(){clearInterval(timer);}
    function shuffle(arr){for(let i=arr.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}return arr;}

    nextLevelBtn.onclick=()=>{ if(currentLevel==="beginner")startLevel("intermediate"); else if(currentLevel==="intermediate")startLevel("advanced"); };
    retryBtn.onclick=()=>{ startLevel(currentLevel); };
    saveScoreBtn.onclick=()=>{
      const name=playerNameInput.value||"Unknown";
      const percent=finalPercent.textContent;
      let records=JSON.parse(localStorage.getItem('leaderboard')||"[]");
      records.push({name,level:currentLevel,score:score,percent:percent});
      localStorage.setItem('leaderboard',JSON.stringify(records));
      renderLeaderboard();
    };
    function renderLeaderboard(){
      leaderboard.innerHTML="";
      let records=JSON.parse(localStorage.getItem('leaderboard')||"[]");
      records.slice(-10).reverse().forEach(r=>{
        const li=document.createElement('li');
        li.textContent=`${r.name} - ${r.level} ${r.percent}%`;
        leaderboard.appendChild(li);
      });
    }
    function saveProgress(percent){
      localStorage.setItem(currentLevel+"Percent",percent);
    }
    function applyUnlocks(){
      const b=parseInt(localStorage.getItem("beginnerPercent")||0);
      const i=parseInt(localStorage.getItem("intermediatePercent")||0);
      if(b>=PASS_PERCENT)intermediateBtn.classList.remove('disabled');
      if(i>=PASS_PERCENT)advancedBtn.classList.remove('disabled');
    }
    beginnerBtn.onclick=()=>startLevel("beginner");
    intermediateBtn.onclick=()=>{if(!intermediateBtn.classList.contains('disabled'))startLevel("intermediate");};
    advancedBtn.onclick=()=>{if(!advancedBtn.classList.contains('disabled'))startLevel("advanced");};

    document.getElementById('startBtn').addEventListener('click', ()=>{
      const name=document.getElementById('startName').value.trim();
      if(!name){alert("Please enter your name to start.");return;}
      playerNameInput.value=name;
      document.getElementById('startPanel').style.display='none';
      applyUnlocks();
      startLevel("beginner");
      renderLeaderboard();
    });
  </script>
</body>
</html>
